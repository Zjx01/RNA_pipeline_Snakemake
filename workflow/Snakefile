import glob
import os
from snakemake.utils import min_version

##### set minimum snakemake version #####
min_version("8.8.0")



#### setup report ####
configfile:"config/config.yaml"

with open(config['sample_file']) as fh:
    sample_reads = dict()
    for line in fh:
        fields = line.strip().split('\t')
        files = [
            path
            for f in fields[1:]
            for path in glob.glob(f)
        ]
        if len(files) != 2:
            raise ValueError(f"Expected two read files per samples, {fields[0]} has {len(files)}: {files}")
        sample_reads[fields[0]] = files
config['sample_reads'] = sample_reads


#### load rules ####
include:"rules/trim.smk"


